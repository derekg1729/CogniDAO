[tox]
envlist = infra_core, mcp_server, web_api, integration

[testenv]
deps = uv
skip_install = true
allowlist_externals = pytest
commands = pytest -q {env:MYPKG_TESTPATH}

[testenv:infra_core]
commands_pre = uv sync --package cogni-infra-core --extra test --active
setenv = MYPKG_TESTPATH = libs/infra_core/tests

[testenv:mcp_server]
commands_pre = uv sync --package mcp-server --extra test --active
setenv = MYPKG_TESTPATH = services/mcp_server/tests

[testenv:web_api]
commands_pre = uv sync --package cogni-web-api --extra test --active
setenv = MYPKG_TESTPATH = services/web_api/tests

[testenv:integration]
commands_pre = uv sync --all-packages --extra dev
setenv = MYPKG_TESTPATH = tests 